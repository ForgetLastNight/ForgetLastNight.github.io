
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="https://www.facebook.com/2008/fbml">
  <head>
    <title>My ParseApp site</title>
    <script src='https://www.parsecdn.com/js/parse-1.2.18.min.js'></script>

  </head>
<body>




<script>
  window.fbAsyncInit = function()
  {
    FB.init({
    appId      : '462337317202554', // App ID
    channelUrl : 'https://forgetlastnight.github.io/CloudCode/public/channel.html', // Channel File
    status     : true, // check login status
    cookie     : true, // enable cookies to allow the server to access the session
    xfbml      : true  // parse XFBML
    });

    // FB.Event.subscribe('auth.authResponseChange', function(response) 
    // {

    //   if (response.status === 'connected')
    //   {
    //     testAPI();
    //   }
    //   else if(response.status === 'not_authorized')
    //   {
    //     FB.login();
    //   } 
    //   else
    //   {
    //     FB.login();
    //   }
    // });
    testAPI();

  };

  // Load the SDK asynchronously
  (function(d){
    var js, id = 'facebook-jssdk', 
    ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); 
    js.id = id; js.async = true;
    js.src = "https://connect.facebook.net/en_US/all.js";
    ref.parentNode.insertBefore(js, ref);
  }(document));


  function testAPI() {


    FB.login(function(response) {
      if (response.authResponse) {
        // user is logged in and granted some permissions.
        FB.api('/me/feed',
          function(results) {
            if (!results || results.error) {
              console.log(results.error);
            } else {
              console.log(results);
              //alert('Post ID: ' + response.id);
              // for(i=0;i<results.length;i++){
                postLink = results['data'];//0]['actions'][0]['link'];
                // posthtml = "<div class='fb-post' data-href="+postLink+" data-width='500'></div>";
                console.log(postLink);

              //}

            }
        });
      } else {
        // User cancelled login or did not fully authorize.
      }
    }, {scope:'read_stream'});

    //this works for reading stream, but need to add read_stream permission




    //this works for posting 
    // FB.api('/me/feed','POST', {message: "Testing that posting works"}, 
    //   function(response) {
    //     if (!response || response.error) {
    //       console.log(response.error);
    //     } else {
    //       console.log(response);
    //       //alert('Post ID: ' + response.id);
    //     }
    // });
  }
</script>

<!--         method: 'stream.publish',
        message: 'I just entered the Your Perfect Kent Day Competition.',
        picture : 'http://apps.facebook.com/perfect-kent-day/',
        link : 'http://apps.facebook.com/perfect-kent-day/',
        name: 'Enter to win or vote for your faourite story here!',
        caption: $title,
        description: $story,
        actions : { name : 'Apply for Kent Teach Jobs...', link : 'http://www.kent-       teach.com/'}
    };

    FB.api('/me/feed', 'POST', publish, function(response) {
    //alert('A post had just been published into the stream on your wall.');
        $('#before-submit').hide();
        $('#after-submit').show();
        $('#loading').fadeOut();
    }); -->

<button onclick="testAPI()">Test</button>

</body>
<div id="fb-root"></div>
</html>
